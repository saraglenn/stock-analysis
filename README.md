# Election_Analysis_Python
## Overview
Refactoring is important to consider when working with large datasets as running code through them can be time consuming if not executed properly. While refactoring does require more code, it does not change the functionality; instead, it increases efficiency by improving the logic, taking fewer steps to analyze the data, and using less computer memory. In an effort to deliver higher efficiency while runing this code, it has been refactored to loop through all of the data at one time. Here we developed a code that would analyze over 3,000 days of stock market trades for FY's 2017/2018 in under one second.   
## Results
### Some Background on The Code Refactored
Since the focus of this refactoring process is efficiency, the code began with initializing the startTimes and endTimes and creating an InputBox since the data being analyzed crossed multiple years. Once the output worksheet was activated and header rows were created the arrays for all tickers could be created. One thing to note here - two additional headers were created: Closing Price and Opening Price. These two additional pieces of data were included as a way to check the accuracy of the code related to a run problem that occured (more information later in this analysis). This is an important step as initializing this string would ensure all data was analyzed and all rows were included in the process. Once the output arrays and for loops were created, code needed to be written to loop over all of the rows in the spreadsheet, then loop through all arrays. Looping through the Ticker and Total Daily Volume was straight forward; however, an problem occurred when writing the specific line of code related to the Return. The Return percentages displayed as very slightly different from those reported in the module. As such, I used the Closing and Opening Price columns to ensure it was accurately reading this data. It was. I also reworked the calculation of code that subtracts tickerStartingPrices from tickerEndingPrices and then divides that by tickerStartingPrices. The concept of the matematical equation worked when checking it against the Closing and Opening Prices; however, the code continues to calculate the Return data slightly off percentage. 
### 2017 - 2018 Comparison
**For a high level overview** we can see from the analysis that 2017 had a more positive Return with only one Ticker (TERP) reporting a negative return. The analysis for 2018 provides a different picture with the majority of Tickers returning a negative return and only two (ENPH, RUN) returning a positive return. Almost all Returns for both years were significantly higher or lower than the average of 14.8% for the S&P 500. While it is unclear why this is from looking at the data, one can infer that there was something happening during the year of 2018 which caused the stock market to take a hit. The year of more negative returns, 2018, yielded a higher Total Daily Volume overall, a lower Closing Price average, and a higher Opening Price average. When comparing the run times, 2017 ran in .101 seconds and 2018 ran in .109 seconds, significantly faster than the previous code *unfactored*. 
## Summary
### Advantages and Disadvantages of Refactored Code
As discussed briefly in the Overview above, advantages of refactoring a code is that it increases efficiency, requires fewer steps, and uses less computer memory; it does all of this without impacting it's behavior. While writing, it is important to make these changes in small pieces and run the code as you build to avoid any undue errors. Refactoring can also help find bugs in your code. Some disadvantages of refactoring include the potential to add bugs to your code and the time it takes to do so. While it can improve efficiency, it isn't always the best option if you're already up against a tight deadline. 

As we look at the original VBA code and compare it to the refactored code we notice immediately that the length of code changed. The refactored code required more steps which required more coding. Refactoring the code reduce technical debt and offered a way to analyze thousands of pieces of stock data more quickly. 
